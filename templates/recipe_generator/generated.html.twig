{% extends 'base.html.twig' %}
{% import "/macros/macros.html.twig" as macros %}

{% block body %}
    <script>
        function printDiv(divName){
            var printContents = document.getElementById(divName).outerHTML;
            var originalContents = document.body.innerHTML;
            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
        }
    </script>
    <main class="container">
        <div id="meal-plan" class="meal-plan-app">
            <div>
                <div id="meal-plan-header" class="pad-small">
                    <h1>
                        <span id="meal-plan-title">My Meal Plan</span>
                    </h1>
                    {% if app.user %}
                    {{ form_start(saveForm) }}
                    <input type="submit" name="commit" value="Save"
                           class="ml-btn-success btn-lg disable-on-click">
                    {% if recipesWereSaved == true %}
                        <a href="{{ path('saved_recipe') }}">{{ 'generated_recipe.saved'|trans }}</a>
                    {% endif %}
                    {{ form_end(saveForm) }}
                    {% endif %}
                </div><!-- meal-plan-header -->
                <div id="meal-plan-content" class="clearfix">
                    <div id="grocery-list-container">
                        <div id="grocery-list">
                            <div id="success-message">
                                <i class="fa fa-check"></i>
                                <h2>For these recipes:</h2>
                            </div>
                            <div>
                                <h3> Ingredients </h3>
                                <ul>
                                    {% if summedRecipes is defined %}
                                        {% for summedRecipe in summedRecipes %}
                                            {{ macros.ingredient(
                                                summedRecipe.0.ingredient.title,
                                                summedRecipe.total ~ summedRecipe.0.measure.title
                                            )  }}
                                        {% endfor %}
                                    {% endif %}
                                </ul>
                                <div class="action-bar">
                                    <button class="ml-btn-link has-tooltip action-bar-print" onClick="printDiv('grocery-list-container')" target="_blank" title="" data-original-title="Print your grocery list">
                                        <i>
                                            <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M448 1536h896v-256h-896v256zm0-640h896v-384h-160q-40 0-68-28t-28-68v-160h-640v640zm1152 64q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128 0v416q0 13-9.5 22.5t-22.5 9.5h-224v160q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-160h-224q-13 0-22.5-9.5t-9.5-22.5v-416q0-79 56.5-135.5t135.5-56.5h64v-544q0-40 28-68t68-28h672q40 0 88 20t76 48l152 152q28 28 48 76t20 88v256h64q79 0 135.5 56.5t56.5 135.5z"></path></svg>
                                        </i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div id="meals" class="pad-small">
                        {% if selectedRecipes is defined %}
                            {% for recipe in selectedRecipes %}
                                <button class="ajax" onclick="kviesti('5.jpeg', 'chicken magic', '2')">click me!</button>
                                <div id="ajax-results">here comes the result</div>
                                {% include "/card/index.html.twig" with {'imageUrl': recipe.imageUrl, 'name': recipe.title, 'id':recipe.id} %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
     </main>
{% endblock %}

{% block javascripts %}
    <script>
        function kviesti($imageUrl, $name, $id) {
            $.ajax({
                url: "/ajax",
                data: {
                    imageUrl: $imageUrl,
                    name: $name,
                    id: $id,

                },
                success: function (result) {
                    console.log(result);
                    //$("#ajax-results").html("<strong>" + result + "</strong> degrees");
                }
            });
        }
    </script>
{% endblock %}

